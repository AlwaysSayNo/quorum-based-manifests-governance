# This file forces the webhooks to point to the local host.minikube.internal
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: validating-webhook-configuration
  annotations:
    # No cert-manager injection for local development
    cert-manager.io/inject-ca-from: null
webhooks:
- name: argocd-change-admission-webhook.governance.nazar.grynko.com
  admissionReviewVersions:
  - v1
  sideEffects: None
  clientConfig:
    # Direct URL to local controller via host.minikube.internal
    service: null
    url: https://host.minikube.internal:9443/mca/validate/argocd-requests
    # Skip certificate verification for local development
    caBundle: ""
- name: mca-validating-webhook.governance.nazar.grynko.com
  admissionReviewVersions:
  - v1
  sideEffects: None
  clientConfig:
    service: null
    url: https://host.minikube.internal:9443/mca/validate
    caBundle: ""
- name: msr-validating-webhook.governance.nazar.grynko.com
  admissionReviewVersions:
  - v1
  sideEffects: None
  clientConfig:
    service: null
    url: https://host.minikube.internal:9443/msr/validate
    caBundle: ""
- name: mrt-validating-webhook.governance.nazar.grynko.com
  admissionReviewVersions:
  - v1
  sideEffects: None
  clientConfig:
    service: null
    url: https://host.minikube.internal:9443/mrt/validate
---
apiVersion: admissionregistration.k8s.io/v1
kind: MutatingWebhookConfiguration
metadata:
  name: mutating-webhook-configuration
  annotations:
    cert-manager.io/inject-ca-from: null
webhooks:
- name: mrt-mutating-webhook.governance.nazar.grynko.com
  admissionReviewVersions:
  - v1
  sideEffects: None
  clientConfig:
    service: null
    url: https://host.minikube.internal:9443/mrt/mutate
    caBundle: ""